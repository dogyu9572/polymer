<?PHPinclude $_SERVER['DOCUMENT_ROOT'] . "/backoffice/pub/inc/admin_top.php";include "./menu.php";include_once $_SERVER ['DOCUMENT_ROOT'] . "/module/member/member.lib.php";include_once $_SERVER ['DOCUMENT_ROOT'] . "/module/coupon/coupon.lib.php";if (! in_array ( "member_manage", $_SESSION [$_SITE ["DOMAIN"]] ["ADMIN"] ["AUTH"] ) && $_SESSION [$_SITE ["DOMAIN"]] ["ADMIN"] ["GRADE"] != "ROOT") :	jsMsg ( "권한이 없습니다." );	jsHistory ( "-1" );endif;if ($_GET['page_size']) {	$scale = $_GET['page_size'];} elseif ($_GET['page_size'] === '0') {	$scale = 0;} else {	$scale = 20;}$_GET['level'] = 90;// DB연결$dblink = SetConn ( $_conf_db ["main_db"] );$subQuery = "";if($_GET['join_type']){	$subQuery .= " AND join_type='".$_GET['join_type']."' ";}if($_GET['job']){	$subQuery .= " AND job='".$_GET['job']."' ";}if($_GET['email_accept']){	$subQuery .= " AND email_accept='".$_GET['email_accept']."' ";}if($_GET['sms_accept']){	$subQuery .= " AND sms_accept='".$_GET['sms_accept']."' ";}$arrList = getMemberList ( mysqli_real_escape_string ( $GLOBALS ['dblink'], $_REQUEST ['jb'] ),  mysqli_real_escape_string ( $GLOBALS ['dblink'], $_REQUEST ['sw'] ), mysqli_real_escape_string ( $GLOBALS ['dblink'], $_REQUEST ['sk'] ), $scale, $_REQUEST ['offset'] , $subQuery);// _DEBUG($arrList);$arrLevel = getArticleList ( $_conf_tbl ["member_level"], 0, 0, "order by level_no desc " );for($i = 0; $i < $arrLevel["total"]; $i ++) {	$arrayLevel[$arrLevel["list"][$i]['level_no']] = $arrLevel["list"][$i]['level_name'];}$arrCouponList = getCouponListAdmin(0, 0, "Y");// DB해제SetDisConn ( $dblink );?><script>  // 선택 삭제시 singleSelect=true 값 변경 falsefunction getSelections(){	var ss = "0";	var rows = $('input:checkbox[name=chk_list]:checked');		for(var i=0; i<rows.length; i++){		var row = rows[i];		//ss.push(row.idx);		ss += ","+row.value;	}	if(rows.length>0){		//alert(ss);		boardDel(ss);	}else{		alert('선택된 항목이 없습니다.');	}	}function boardDel(val){	//location.href="/backoffice/module/member/ajax_member_del.php?g_idx="+val;	//return;	//alert(val);	//return;	if(confirm("삭제 처리 하시겠습니까?")) {		$.post("/backoffice/module/member/ajax_member_out.php", {g_idx: val },		function(data){					//alert(data);			location.reload();		});	}}function memberLevel(idx, lval){	//if(confirm("해당 회원의 등급을 변경 하시겠습니까?")) {		$.post("/backoffice/module/member/ajax_member_level.php", {g_idx: idx,levelval: lval},		function(data){					//alert(data);			location.reload();		});	//}}function userCoupon(uid, idx){	if(confirm("해당 회원에게 쿠폰을 발행합니다. 계속 하시겠습니까?")) {		$.post("/backoffice/module/coupon/coupon_evn.php", {evnMode:"user_coupon", idx: idx,user_id: uid},		function(data){					if(data=="OK"){				alert("발행되었습니다.");			}			//location.reload();		});	}}function delMember(id){	var cfm;	cfm =false;	cfm = confirm(id + " 이 회원을 삭제처리 하시겠습니까?\n\n삭제처리시 복구 불가능합니다.");	if(cfm==true){		document.frmContentsHidden.user_id.value = id;		document.frmContentsHidden.submit();	}}</script><div class="container">	<div class="title">회원 관리</div>	<form name="frmSort" method="get" action="member_outlist.php">	<div class="inbox top_search">		<dl>			<dt>탈퇴날짜</dt>			<dd><input type="text" class="datepicker" name="ds_date" value="<?=$_GET['ds_date']?>"/><em>~</em><input type="text" class="datepicker" name="de_date" value="<?=$_GET['de_date']?>" /></dd>		</dl>		<dl>			<dt>가입구분</dt>			<dd>				<select name="join_type" id="" style="width:100px;">					<option value="">전체</option>					<option value="homepage" <?=$_GET['join_type']=="homepage"?"selected":""?>>일반</option>					<option value="naver"  <?=$_GET['join_type']=="naver"?"selected":""?>>네이버</option>					<option value="kakao"  <?=$_GET['join_type']=="kakao"?"selected":""?>>카카오</option>				</select>			</dd>		</dl>        <dl class="w2">            <dt>가입일</dt>            <dd><input type="text" class="datepicker" name="s_date" value="<?=$_REQUEST['s_date']?>"  /><em>~</em><input type="text" class="datepicker" name="e_date" value="<?=$_REQUEST['e_date']?>" /></dd>        </dl>		<dl class="search_wrap">			<dt>검색어</dt>			<dd>				<select name="sw" style="width:100px;">					<option value="all" <?=$_REQUEST['sw']=="all"?" selected":""?>>전체</option>					<option value="name" <?=$_REQUEST['sw']=="name"?" selected":""?>>이름</option>					<option value="id" <?=$_REQUEST['sw']=="id"?" selected":""?>>이메일(아이디)</option>				</select>				<input type="text" name="sk" value="<?=$_GET['sk']?>" onkeypress="if( event.keyCode == 13 ){document.frmSort.submit();}"/>				<button type="button" class="search" onclick="document.frmSort.submit()">검색</button>			</dd>		</dl>	</div>	<div class="inbox">		<div class="bdr_top">			<div class="left">				<div class="total">Total : <strong><?=number_format($arrList['total'])?></strong></div>				<div class="down">				</div>			</div>			<div class="bdr_right">                <div class="btns">                    <a href="/backoffice/module/member/member_outlist_to_xls.php?level=<?=urlencode($_GET['level'])?>&user_level=<?=urlencode($_GET['level'])?>&join_type=<?=urlencode($_REQUEST['join_type'])?>&email_accept=<?=urlencode($_REQUEST['email_accept'])?>&sms_accept=<?=urlencode($_REQUEST['sms_accept'])?>&s_date=<?=urlencode($_REQUEST['s_date'])?>&e_date=<?=urlencode($_REQUEST['e_date'])?>&login_last=<?=urlencode($_REQUEST['login_last'])?>&sw=<?=urlencode($_REQUEST['sw'])?>&sk=<?=urlencode($_REQUEST['sk'])?>&page_size=<?=urlencode($_REQUEST['page_size'])?>" class="excel" download>엑셀파일로 저장<span class="pc_vw"></span></a>                </div>                <div class="count">				<select name="page_size" onchange="document.frmSort.submit()" style="width:100px;">                    <option value="0" <?if($scale=="0"){echo 'selected="selected"';}?>>전체</option>                    <option value="500" <?if($scale=="500"){echo 'selected="selected"';}?>>500</option>                    <option value="400" <?if($scale=="400"){echo 'selected="selected"';}?>>400</option>                    <option value="300" <?if($scale=="300"){echo 'selected="selected"';}?>>300</option>                    <option value="200" <?if($scale=="200"){echo 'selected="selected"';}?>>200</option>                    <option value="100" <?if($scale=="100"){echo 'selected="selected"';}?>>100</option>					<option value="50" <?if($scale=="50"){echo 'selected="selected"';}?>>50</option>					<option value="40" <?if($scale=="40"){echo 'selected="selected"';}?>>40</option>					<option value="30" <?if($scale=="30"){echo 'selected="selected"';}?>>30</option>					<option value="20" <?if($scale=="20"){echo 'selected="selected"';}?>>20</option>					<option value="15" <?if($scale=="15"){echo 'selected="selected"';}?>>15</option>					<option value="10" <?if($scale=="10"){echo 'selected="selected"';}?>>10</option>				</select>				개씩 보기				</div>				<!--<div class="btns">					<a href="javascript:void(0);" onclick="getSelections()" class="btn btn_del">선택삭제</a>				</div>-->			</div>		</div>		</form><!-- over_tbl : 테이블을 좌우로 스크롤 할 때 사용합니다. --><!-- mo_break_tbl : 767px 이하에서 테이블 구조를 깰 때 사용합니다. -->		<div class="over_tbl mo_break_tbl">			<div class="bdr_list tac">				<table>					<colgroup class="pc_vw">						<!--<col class="check">-->						<col class="w4p">						<col class="w8p">						<col class="w20p">						<col class="w15p">						<col class="w15p">                        <col class="w12p">						<col class="w10p">					</colgroup>					<thead>						<tr>								<!--<th><label class="check notxt"><input type="checkbox" name="" id="allCheck"><i></i></label></th>-->							<th class="pc_vw">No.</th>							<th class="pc_vw">가입구분</th>							<th class="pc_vw">이메일(아이디)</th>							<th class="pc_vw">이름</th>							<th class="pc_vw">휴대폰번호</th>							<th class="pc_vw">메일 수신동의</th>							<th class="pc_vw">SMS 수신동의</th>							<th class="pc_vw">탈퇴날짜</th>							<th class="pc_vw">관리</th>						</tr>					</thead>					<tbody>					<?					if($arrList['list']['total'] > 0){						for ($i=0;$i<$arrList['list']['total'];$i++){							$newTxt = "";							for($c=0;$c<$arrCount['total'];$c++){								if($arrCount['list'][$c]['user_editdt']==$arrList['list'][$i]['user_editdt']){									$newTxt = "New";								}							}                            if ($arrList['list'][$i]['before'] == 'Y') {                                $user_name = base64_decode($arrList['list'][$i]['user_name']);                                $mobile = base64_decode($arrList['list'][$i]['mobile']);                                $email = base64_decode($arrList['list'][$i]['email']);                            }                            else {                                $user_name = $arrList['list'][$i]['user_name'];                                $mobile = $arrList['list'][$i]['mobile'];                                $email = $arrList['list'][$i]['email'];                            }					?>						<tr>							<!--<td class="chkbox"><label class="check notxt"><input type="checkbox" value="<?=$arrList["list"][$i]['idx']?>" name="chk_list"><i></i></label></td>-->							<td><i class="mo_vw">No.</i><?=number_format($arrList['total']-$i-$_REQUEST['offset'])?></td>							<td><i class="mo_vw">가입구분</i><?=$_SITE["MEMBER_TYPE"][$arrList['list'][$i]['join_type']]?></td>							<td><i class="mo_vw"><a href="member_info.php?user_id=<?=$arrList['list'][$i]['user_id']?>&listURL=<?=urlencode($_SERVER['REQUEST_URI'])?>" class="linktxt">ID(아이디)</i><?=$arrList['list'][$i]['user_id']?></a></td>							<td><i class="mo_vw">이름</i><?=$user_name?> <strong style="color:red;"><?=$newTxt?></strong></td>							<td><i class="mo_vw">휴대폰번호</i><?=$mobile?></td>							<td><i class="mo_vw">메일 수신동의</i><?=$arrList['list'][$i]['email_accept']?></td>							<td><i class="mo_vw">SMS 수신동의</i><?=$arrList['list'][$i]['sms_accept']?></td>							<td><i class="mo_vw">탈퇴날짜</i><?=$arrList['list'][$i]['outdt']?><br><?//=$arrList['list'][$i]['user_editdt']?> </td>								<td class="mono_btm"><i class="mo_vw">관리</i>								<div class="btns"><!--									<a href="member_info.php?user_id=--><?php //=$arrList['list'][$i]['user_id']?><!--&listURL=--><?php //=urlencode($_SERVER['REQUEST_URI'])?><!--" class="btn perf">확인</a>-->									<button type="button" class="btn del" onclick="delMember('<?=$arrList['list'][$i]['user_id']?>');">삭제</button>								</div>							</td>						</tr>					<?						}					}else{					?>					<tr height="100">						<td colspan="10">등록된 데이터가 없습니다.</td>					</tr>					<?}?>					</tbody>				</table>			</div>		</div>		<div class="bdr_btm">			<div class="paging">			<?=pageNavigationBackoffice($arrList['total'],$scale,$pagescale,$_REQUEST['offset'],"&jb=".$_REQUEST['jb']."&sw=".$_REQUEST['sw']."&sk=".$_REQUEST['sk']."&user_level=".$_REQUEST['user_level'])?>			</div>	<!-- 			<div class="btns">				<a href="javascript:void(0);" onclick="getSelections()" class="btn btn_del">선택삭제</a>			</div> -->		</div>	</div></div><form name="frmContentsHidden" method="post" action="member_evn.php">	<input type="hidden" name="evnMode" value="out">	<input type="hidden" name="user_id">	<input type="hidden" name="returnURL" value="<?=$_SERVER['REQUEST_URI']?>"></form><script type="text/javascript">//<![CDATA[$(document).ready(function(){//달력	$(".datepicker").datepicker({		dateFormat: 'yy-mm-dd',		showMonthAfterYear:true,		showOn: "both",		buttonImage: "/images/icon_month.gif",         buttonImageOnly: true,		changeYear: true,		changeMonth: true,		yearRange: 'c-100:c+10',		yearSuffix: "년 ",		monthNamesShort: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'],		dayNamesMin: ['일','월','화','수','목','금','토']	});//체크박스	var $allCheck = $('#allCheck');	$allCheck.change(function () {		var $this = $(this);		var checked = $this.prop('checked');		$('input[name="chk_list"]').prop('checked', checked);	});	var boxes = $('input[name="chk_list"]');	boxes.change(function () {		var boxLength = boxes.length;		var checkedLength = $('input[name="chk_list"]:checked').length;		var selectallCheck = (boxLength == checkedLength);		$allCheck.prop('checked', selectallCheck);	});});//]]></script><?php include("pub/inc/footer.php") ?>